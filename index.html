<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	
	<link rel="stylesheet" type="text/css" href="style.css">
	
	<script>
	$(document).ready(function()
	{
		//We'll eventually want to make this an 8x8 game
		var $maxBoardWidth = 4, $maxBoardHeight = 4;
		var $playerSelected = "", $foxPlaced = "False", $hound1Placed = "False", $hound2Placed = "False", $hound3Placed = "False";
		var $fox_x, $fox_y, $hound1_x, $hound1_y, $hound2_x, $hound2_y, $hound3_x, $hound3_y;
		var $user_clicked_x, $user_clicked_y;
		var $hound1Role="",$hound2Role="",$hound3Role="";
		var $strategy="";
	
		//-------------------
		// Set up board
		//-------------------
		function setUpBoard(){
			for(var $y=0;$y < $maxBoardWidth;$y++){
				for(var $x=0;$x < $maxBoardHeight;$x++){
					$("#board").append("<button class='tile' id =tileX" + $x + "Y" + $y + ">");
					$("#tileX" + $x + "Y" + $y).data("xCoord",$x);
					$("#tileX" + $x + "Y" + $y).data("yCoord",$y);
				}
				$("#board").append("<br>");
			}
		
			//Verify that the ids of the tiles are working correctly
			/*
			xvalue = $("#tileX" + $x + "Y" + $y).data("xCoord");
			yvalue = $("#tileX" + $x + "Y" + $y).data("yCoord");
			console.log("x: " + xvalue + ",y: " + yvalue);
			*/
		};
		
		setUpBoard();
		
		//--------------------------
		// Select player to place
		//--------------------------
		
		$("#foxButton").click(function(){
			placePlayer($(this).attr('id'));
		});
		
		$(".houndButton").each(function(index){
			$(this).click(function(){
				placePlayer($(this).attr('id'));
			})
		});
		
		function placePlayer(playerID){
			$playerSelected = playerID;
			//console.log(playerID);
		};
		
		//------------------
		// Play the game
		//------------------
		$(".tile").each(function(index){
			$(this).click(function(){
			
				//
				$user_clicked_x = $(this).data("xCoord");
				$user_clicked_y = $(this).data("yCoord");
				//console.log($(this).attr('id'));
				//console.log("x: " + $user_clicked_x + ", y: " + $user_clicked_y);
				//
				
				// Set up the players
				if($foxPlaced == "False" || $hound1Placed == "False" || $hound2Placed == "False" || $hound3Placed == "False")
				{
					if($playerSelected == "foxButton" && $foxPlaced == "False")
					{
						$(this).addClass("foxButton");
						$foxPlaced = "True";
						$fox_x = $user_clicked_x;
						$fox_y = $user_clicked_y;
						//console.log("Fox placement: x:" + $fox_x + " ,y:" + $fox_y);
					}
					if($playerSelected == "houndButton1" && $hound1Placed == "False")
					{
						$(this).addClass("houndButton");
						$hound1Placed = "True";
						$hound1_x = $user_clicked_x;
						$hound1_y = $user_clicked_y;
						//console.log("Hound1 placement: x:" + $hound1_x + " ,y:" + $hound1_y);
					}
					if($playerSelected == "houndButton2" && $hound2Placed == "False")
					{
						$(this).addClass("houndButton");
						$hound2Placed = "True";
						$hound2_x = $user_clicked_x;
						$hound2_y = $user_clicked_y;
						//console.log("Hound2 placement: x:" + $hound2_x + " ,y:" + $hound2_y);
					}
					if($playerSelected == "houndButton3" && $hound3Placed == "False")
					{
						$(this).addClass("houndButton");
						$hound3Placed = "True";
						$hound3_x = $user_clicked_x;
						$hound3_y = $user_clicked_y;
						//console.log("Hound3 placement: x:" + $hound3_x + " ,y:" + $hound3_y);
					}
				}
				// Play the game
				else{
						checkForFoxValidMoves();
						developStrategy();
						
						//Need to determine if a hound is touching the fox before the hound moves
						determineTouchingTrappers($fox_x+1,$fox_y,"LeftTrapper");
						determineTouchingTrappers($fox_x-1,$fox_y,"RightTrapper");
						determineTouchingTrappers($fox_x,$fox_y+1,"TopTrapper");
						determineTouchingTrappers($fox_x,$fox_y-1,"BottomTrapper");
						
						decideHoundTile(1,$hound1Role,$hound1_x,$hound1_y);
						decideHoundTile(2,$hound2Role,$hound2_x,$hound2_y);
						decideHoundTile(3,$hound3Role,$hound3_x,$hound3_y);
						
						//Need to determine if a hound is touching the fox after the hound moves
						determineTouchingTrappers($fox_x+1,$fox_y,"LeftTrapper");
						determineTouchingTrappers($fox_x-1,$fox_y,"RightTrapper");
						determineTouchingTrappers($fox_x,$fox_y+1,"TopTrapper");
						determineTouchingTrappers($fox_x,$fox_y-1,"BottomTrapper");
						
						checkForFoxValidMoves();
						
						console.log("Hound1 Role:" + $hound1Role + "," + "Hound2 Role:" + $hound2Role + "," + "Hound3 Role:" + $hound3Role);
						console.log("Hound1:" + $hound1_x + "," + $hound1_y);
						console.log("Hound2:" + $hound2_x + "," + $hound2_y);
						console.log("Hound3:" + $hound3_x + "," + $hound3_y);
				}
				
			});
		});
		
		function checkForFoxValidMoves(){
			//If the fox is not blocked by a hound or the edge then it can move left
			if($fox_x-1>=0 && 
			($fox_x-1 != $hound1_x || $fox_y != $hound1_y) &&
			($fox_x-1 != $hound2_x || $fox_y != $hound2_y) &&
			($fox_x-1 != $hound3_x || $fox_y != $hound3_y))
			{
				//console.log("Can move left");
				moveFox("Left");
			}
			//If the fox is not blocked by a hound or the edge then it can move right
			if($fox_x+1<($maxBoardWidth) &&
			($fox_x+1 != $hound1_x || $fox_y != $hound1_y) &&
			($fox_x+1 != $hound2_x || $fox_y != $hound2_y) &&
			($fox_x+1 != $hound3_x || $fox_y != $hound3_y))
			{
				//console.log("Can move right");
				moveFox("Right");
			}
			//If the fox is not blocked by a hound or the edge then it can move up
			if($fox_y-1>=0 &&
			($fox_x != $hound1_x || $fox_y-1 != $hound1_y) &&
			($fox_x != $hound2_x || $fox_y-1 != $hound2_y) &&
			($fox_x != $hound3_x || $fox_y-1 != $hound3_y))
			{
				//console.log("Can move up");
				moveFox("Up");
			}
			//If the fox is not blocked by a hound or the edge then it can move down
			if($fox_y+1<($maxBoardHeight) &&
			($fox_x != $hound1_x || $fox_y+1 != $hound1_y) &&
			($fox_x != $hound2_x || $fox_y+1 != $hound2_y) &&
			($fox_x != $hound3_x || $fox_y+1 != $hound3_y))
			{
				//console.log("Can move down");
				moveFox("Down");
			}
			//If the fox is blocked on all sides then the game is overflow
			if(($fox_x-1<0 || ($fox_x-1 == $hound1_x && $fox_y == $hound1_y) || ($fox_x-1 == $hound2_x && $fox_y == $hound2_y) || ($fox_x-1 == $hound3_x && $fox_y == $hound3_y)) && //left side
			($fox_x+1>=($maxBoardWidth) || ($fox_x+1 == $hound1_x && $fox_y == $hound1_y) || ($fox_x+1 == $hound2_x && $fox_y == $hound2_y) || ($fox_x+1 == $hound3_x && $fox_y == $hound3_y)) && //right side
			($fox_y-1<0 || ($fox_x == $hound1_x && $fox_y-1 == $hound1_y) || ($fox_x == $hound2_x && $fox_y-1 == $hound2_y) || ($fox_x == $hound3_x && $fox_y-1 == $hound3_y)) && //top side
			($fox_y+1>=($maxBoardHeight) || ($fox_x == $hound1_x && $fox_y+1 == $hound1_y) || ($fox_x == $hound2_x && $fox_y+1 == $hound2_y) || ($fox_x == $hound3_x && $fox_y+1 == $hound3_y))) //bottom side
			{
				alert("game over");
			}
		};
		
		function moveFox(direction){
			
			switch(direction)
			{
				case "Left":
					moveFoxToDifferentTile($fox_x-1,$fox_y);
					break;
				case "Right":
					moveFoxToDifferentTile($fox_x+1,$fox_y);
					break;
				case "Up":
					moveFoxToDifferentTile($fox_x,$fox_y-1);
					break;
				case "Down":
					moveFoxToDifferentTile($fox_x,$fox_y+1);
					break;
				default:
					break;
			}
		};
		
		function moveFoxToDifferentTile(ParamX,ParamY){
			if($user_clicked_x == ParamX && $user_clicked_y == ParamY)
			{
				//Remove red from the current tile
				$("#tileX" + $fox_x + "Y" + $fox_y).removeClass("foxButton");
			
				//Move fox location and apply red to new tile
				$fox_x = $user_clicked_x;
				$fox_y = $user_clicked_y;
				$("#tileX" + $fox_x + "Y" + $fox_y).addClass("foxButton");
			}
		};
		
		//----------------------------------
		// Develop Strategy
		//----------------------------------
		
		function developStrategy(){
			//Determine which edge the fox is closest to
			var $shortestDistanceToEdge=0, $distanceToEdge=0;
			
			//Check how far from the top
			$shortestDistanceToEdge = Math.abs($fox_y - 0);
			$strategy = "TrapTop";
			
			//Check how far from the bottom (watch out for 'off by one' error)
			$distanceToEdge = Math.abs($fox_y - ($maxBoardHeight-1));
			if($shortestDistanceToEdge > $distanceToEdge)
			{
				$strategy = "TrapBottom";
				$shortestDistanceToEdge = $distanceToEdge;
			}
			
			//Check how far from the left
			$distanceToEdge = Math.abs($fox_x - 0);
			if($shortestDistanceToEdge > $distanceToEdge)
			{
				$strategy = "TrapLeft";
				$shortestDistanceToEdge = $distanceToEdge;
			}
			
			//Check how far from the right (watch out for 'off by one' error)
			$distanceToEdge = Math.abs($fox_x - ($maxBoardWidth-1));
			if($shortestDistanceToEdge > $distanceToEdge)
			{
				$strategy = "TrapRight";
				$shortestDistanceToEdge = $distanceToEdge;
			}
			console.log("-------------------");
			console.log($strategy);
			console.log("-------------------");
		};
		
		//--------------------------------
		// Determine Touching Trappers
		//--------------------------------
		function determineTouchingTrappers(ParamX,ParamY,trapperType){
			if($hound1_x == ParamX && $hound1_y == ParamY)
			{
				$hound1Role = trapperType;
				assignTouchingTrappers($hound1Role);
			}
			else if($hound2_x == ParamX && $hound2_y == ParamY)
			{
				$hound2Role = trapperType;
				assignTouchingTrappers($hound2Role);
			}
			else if($hound3_x == ParamX && $hound3_y == ParamY)
			{
				$hound3Role = trapperType;
				assignTouchingTrappers($hound3Role);
			}
		};
		
		function assignTouchingTrappers(houndRole)
		{
			switch (houndRole){
				case "LeftTrapper":
					$leftTrapperAssigned = "True";
					console.log("Left trapper assigned!");
					break;
				case "RightTrapper":
					$rightTrapperAssigned = "True";
					console.log("Right trapper assigned!");
					break;
				case "TopTrapper":
					$topTrapperAssigned = "True";
					console.log("Top trapper assigned!");
					break;
				case "BottomTrapper":
					$bottomTrapperAssigned = "True";
					console.log("Bottom trapper assigned!");
					break;
				default:
					break;
			}
		};
		
	//----------------------------------
	// Check Hound Move Availability
	//----------------------------------
	function checkHoundMoveAvailability(HoundNum, ParamX, ParamY)
	{
		//hound1
		if(HoundNum==1)
		{
			//Check if the hound is within range to move to the new square
			if((ParamX==$hound1_x || ParamX==$hound1_x+1 || ParamX==$hound1_x-1) && (ParamY==$hound1_y || ParamY==$hound1_y-1 || ParamY==$hound1_y+1))
			{
				//Check that the hound will not move past the edges of the board
				if((ParamX >= 0 && ParamX < $maxBoardWidth) && (ParamY >= 0 && ParamY < $maxBoardHeight))
				{
					//Check that there are no other players occupying the tile
					if((ParamX == $hound2_x && ParamY == $hound2_y)
					|| (ParamX == $hound3_x && ParamY == $hound3_y)
					|| (ParamX == $fox_x && ParamY == $fox_y))
					{
						return "False";
					}
					else
					{
						return "True";
					}
				}
			}
		}
		
		//hound2
		else if(HoundNum==2)
		{
			//Check if the hound is within range to move to the new square
			if((ParamX==$hound2_x || ParamX==$hound2_x+1 || ParamX==$hound2_x-1) && (ParamY==$hound2_y || ParamY==$hound2_y-1 || ParamY==$hound2_y+1))
			{
				//Check that the hound will not move past the edges of the board
				if((ParamX >= 0 && ParamX < $maxBoardWidth) && (ParamY >= 0 && ParamY < $maxBoardHeight))
				{
					//Check that there are no other players occupying the tile
					if((ParamX == $hound1_x && ParamY == $hound1_y)
					|| (ParamX == $hound3_x && ParamY == $hound3_y)
					|| (ParamX == $fox_x && ParamY == $fox_y))
					{
						return "False";
					}
					else
					{
						return "True";
					}
				}
			}
		}
		
		//hound3
		else if(HoundNum==3)
		{
			//Check if the hound is within range to move to the new square
			if((ParamX==$hound3_x || ParamX==$hound3_x+1 || ParamX==$hound3_x-1) && (ParamY==$hound3_y || ParamY==$hound3_y-1 || ParamY==$hound3_y+1))
			{
				//Check that the hound will not move past the edges of the board
				if((ParamX >= 0 && ParamX < $maxBoardWidth) && (ParamY >= 0 && ParamY < $maxBoardHeight))
				{
					//Check that there are no other players occupying the tile
					if((ParamX == $hound1_x && ParamY == $hound1_y)
					|| (ParamX == $hound2_x && ParamY == $hound2_y)
					|| (ParamX == $fox_x && ParamY == $fox_y))
					{
						return "False";
					}
					else
					{
						return "True";
					}
				}
			}
		}
	};
	
	//-------------------
	// Move Hound
	//-------------------
	function moveHound(HoundNum,ParamX,ParamY){
		var $houndLocationX, $houndLocationY;
		
		if(HoundNum==1)
		{
			$houndLocationX = $hound1_x;
			$houndLocationY = $hound1_y;
			
			//Change location of Hound1
			$hound1_x = ParamX;
			$hound1_y = ParamY;
			$hound1Role="";
		}
		else if(HoundNum==2)
		{
			$houndLocationX = $hound2_x;
			$houndLocationY = $hound2_y;
			
			//Change location of Hound2
			$hound2_x = ParamX;
			$hound2_y = ParamY;
			$hound2Role="";
		}
		else if(HoundNum==3)
		{
			$houndLocationX = $hound3_x;
			$houndLocationY = $hound3_y;
			
			//Change location of Hound2
			$hound3_x = ParamX;
			$hound3_y = ParamY;
			$hound3Role="";
		}
		
		//Remove blue from the hound's current tile
		$("#tileX" + $houndLocationX + "Y" + $houndLocationY).removeClass("houndButton");
	
		//Move hound location and apply blue to new tile
		$("#tileX" + ParamX + "Y" + ParamY).addClass("houndButton");
	};//MoveHound
	
	//--------------------------------------------
		// Decide Hound Tile
		//--------------------------------------------
		function decideHoundTile(houndNumber,houndRole,houndX,houndY)
		{
			switch(houndRole)
			{
				case "RightTrapper":
					if(checkHoundMoveAvailability(houndNumber,houndX+1,houndY) == "True")
					{
						moveHound(houndNumber,houndX+1,houndY);
					}
					break;
				case "LeftTrapper":
					if(checkHoundMoveAvailability(houndNumber,houndX-1,houndY) == "True")
					{
						moveHound(houndNumber,houndX-1,houndY);
					}
					break;
				case "BottomTrapper":
					if(checkHoundMoveAvailability(houndNumber,houndX,houndY+1) == "True")
					{
						moveHound(houndNumber,houndX,houndY+1);
					}
					break;
				case "TopTrapper":
					if(checkHoundMoveAvailability(houndNumber,houndX,houndY-1) == "True")
					{
						moveHound(houndNumber,houndX,houndY-1);
					}
					break;
				default:
					console.log("No role assigned to Hound" + houndNumber);
					break; 
			}
		};
	
	
	
});
	
	</script>
</head>
<body>
<div class="container">

	<div id="buttonArea">
		<input type='submit' id="foxButton" value="Fox" class="foxButton">
		<input type='submit' id="houndButton1" value="Hound1" class="houndButton">
		<input type='submit' id="houndButton2" value="Hound2" class="houndButton">
		<input type='submit' id="houndButton3" value="Hound3" class="houndButton">
	</div>
		
	<center>	
		<div id="board">
		</div>
	</center>
		
</div>
</body>
</html>
