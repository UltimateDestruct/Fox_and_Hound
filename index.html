<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	
	<link rel="stylesheet" type="text/css" href="style.css">
	
	<script>
	$(document).ready(function()
	{
		//We'll eventually want to make this an 8x8 game
		var $maxBoardWidth = 4, $maxBoardHeight = 4;
		var $playerSelected = "", $foxPlaced = "False", $hound1Placed = "False", $hound2Placed = "False", $hound3Placed = "False";
		var $fox_x, $fox_y, $hound1_x, $hound1_y, $hound2_x, $hound2_y, $hound3_x, $hound3_y;
		var $user_clicked_x, $user_clicked_y;
	
		//-------------------
		// Set up board
		//-------------------
		function setUpBoard(){
			for(var $y=0;$y < $maxBoardWidth;$y++){
				for(var $x=0;$x < $maxBoardHeight;$x++){
					$("#board").append("<button class='tile' id =tileX" + $x + "Y" + $y + ">");
					$("#tileX" + $x + "Y" + $y).data("xCoord",$x);
					$("#tileX" + $x + "Y" + $y).data("yCoord",$y);
				}
				$("#board").append("<br>");
			}
		
			//Verify that the ids of the tiles are working correctly
			/*
			xvalue = $("#tileX" + $x + "Y" + $y).data("xCoord");
			yvalue = $("#tileX" + $x + "Y" + $y).data("yCoord");
			console.log("x: " + xvalue + ",y: " + yvalue);
			*/
		};
		
		setUpBoard();
		
		//--------------------------
		// Select player to place
		//--------------------------
		
		$("#foxButton").click(function(){
			placePlayer($(this).attr('id'));
		});
		
		$(".houndButton").each(function(index){
			$(this).click(function(){
				placePlayer($(this).attr('id'));
			})
		});
		
		function placePlayer(playerID){
			$playerSelected = playerID;
			//console.log(playerID);
		};
		
		//------------------
		// Play the game
		//------------------
		$(".tile").each(function(index){
			$(this).click(function(){
			
				//
				$user_clicked_x = $(this).data("xCoord");
				$user_clicked_y = $(this).data("yCoord");
				console.log($(this).attr('id'));
				console.log("x: " + $user_clicked_x + ", y: " + $user_clicked_y);
				//
				
				// Set up the players
				if($foxPlaced == "False" || $hound1Placed == "False" || $hound2Placed == "False" || $hound3Placed == "False")
				{
					if($playerSelected == "foxButton" && $foxPlaced == "False")
					{
						$(this).addClass("foxButton");
						$foxPlaced = "True";
						$fox_x = $user_clicked_x;
						$fox_y = $user_clicked_y;
						//console.log("Fox placement: x:" + $fox_x + " ,y:" + $fox_y);
					}
					if($playerSelected == "houndButton1" && $hound1Placed == "False")
					{
						$(this).addClass("houndButton");
						$hound1Placed = "True";
						$hound1_x = $user_clicked_x;
						$hound1_y = $user_clicked_y;
						//console.log("Hound1 placement: x:" + $hound1_x + " ,y:" + $hound1_y);
					}
					if($playerSelected == "houndButton2" && $hound2Placed == "False")
					{
						$(this).addClass("houndButton");
						$hound2Placed = "True";
						$hound2_x = $user_clicked_x;
						$hound2_y = $user_clicked_y;
						//console.log("Hound2 placement: x:" + $hound2_x + " ,y:" + $hound2_y);
					}
					if($playerSelected == "houndButton3" && $hound3Placed == "False")
					{
						$(this).addClass("houndButton");
						$hound3Placed = "True";
						$hound3_x = $user_clicked_x;
						$hound3_y = $user_clicked_y;
						//console.log("Hound3 placement: x:" + $hound3_x + " ,y:" + $hound3_y);
					}
				}
				// Play the game
				else{
						checkForFoxValidMoves();
						developStrategy();
						assignRoles();
				}
				
			});
		});
		
		function checkForFoxValidMoves(){
			//If the fox is not blocked by a hound or the edge then it can move left
			if($fox_x-1>=0 && 
			($fox_x-1 != $hound1_x || $fox_y != $hound1_y) &&
			($fox_x-1 != $hound2_x || $fox_y != $hound2_y) &&
			($fox_x-1 != $hound3_x || $fox_y != $hound3_y))
			{
				//console.log("Can move left");
				moveFox("Left");
			}
			//If the fox is not blocked by a hound or the edge then it can move right
			if($fox_x+1<($maxBoardWidth) &&
			($fox_x+1 != $hound1_x || $fox_y != $hound1_y) &&
			($fox_x+1 != $hound2_x || $fox_y != $hound2_y) &&
			($fox_x+1 != $hound3_x || $fox_y != $hound3_y))
			{
				//console.log("Can move right");
				moveFox("Right");
			}
			//If the fox is not blocked by a hound or the edge then it can move up
			if($fox_y-1>=0 &&
			($fox_x != $hound1_x || $fox_y-1 != $hound1_y) &&
			($fox_x != $hound2_x || $fox_y-1 != $hound2_y) &&
			($fox_x != $hound3_x || $fox_y-1 != $hound3_y))
			{
				//console.log("Can move up");
				moveFox("Up");
			}
			//If the fox is not blocked by a hound or the edge then it can move down
			if($fox_y+1<($maxBoardHeight) &&
			($fox_x != $hound1_x || $fox_y+1 != $hound1_y) &&
			($fox_x != $hound2_x || $fox_y+1 != $hound2_y) &&
			($fox_x != $hound3_x || $fox_y+1 != $hound3_y))
			{
				//console.log("Can move down");
				moveFox("Down");
			}
		};
		
		function moveFox(direction){
			
			//Change position of fox and apply red to the tile
			/*$fox_x = $user_clicked_x;
			$fox_y = $user_clicked_y;
			$("#tileX" + $fox_x + "Y" + $fox_y).addClass("foxButton");*/
			//console.log("New x:" + $fox_x + ", New y:" + $fox_y);
			
			switch(direction)
			{
				case "Left":
					if($user_clicked_x == $fox_x-1 && $user_clicked_y == $fox_y)
					{
						//Remove red from the current tile
						$("#tileX" + $fox_x + "Y" + $fox_y).removeClass("foxButton");
					
						//Move fox location and apply red to new tile
						$fox_x = $user_clicked_x;
						$fox_y = $user_clicked_y;
						$("#tileX" + $fox_x + "Y" + $fox_y).addClass("foxButton");
					}
					break;
				case "Right":
					if($user_clicked_x == $fox_x+1 && $user_clicked_y == $fox_y)
					{
						//Remove red from the current tile
						$("#tileX" + $fox_x + "Y" + $fox_y).removeClass("foxButton");
					
						//Move fox location and apply red to new tile
						$fox_x = $user_clicked_x;
						$fox_y = $user_clicked_y;
						$("#tileX" + $fox_x + "Y" + $fox_y).addClass("foxButton");
					}
					break;
					case "Up":
					if($user_clicked_x == $fox_x && $user_clicked_y == $fox_y-1)
					{
						//Remove red from the current tile
						$("#tileX" + $fox_x + "Y" + $fox_y).removeClass("foxButton");
					
						//Move fox location and apply red to new tile
						$fox_x = $user_clicked_x;
						$fox_y = $user_clicked_y;
						$("#tileX" + $fox_x + "Y" + $fox_y).addClass("foxButton");
					}
					break;
					case "Down":
					if($user_clicked_x == $fox_x && $user_clicked_y == $fox_y+1)
					{
						//Remove red from the current tile
						$("#tileX" + $fox_x + "Y" + $fox_y).removeClass("foxButton");
					
						//Move fox location and apply red to new tile
						$fox_x = $user_clicked_x;
						$fox_y = $user_clicked_y;
						$("#tileX" + $fox_x + "Y" + $fox_y).addClass("foxButton");
					}
					break;
				default:
					break;
			}
		};
		
		function developStrategy(){
			//Determine which edge the fox is closest to
			var $strategy="", $shortestDistanceToEdge=0, $distanceToEdge=0;
			
			//Check how far from the top
			$shortestDistanceToEdge = Math.abs($fox_y - 0);
			$strategy = "TrapTop";
			
			//Check how far from the bottom (watch out for 'off by one' error)
			$distanceToEdge = Math.abs($fox_y - ($maxBoardHeight-1));
			if($shortestDistanceToEdge > $distanceToEdge)
			{
				$strategy = "TrapBottom";
				$shortestDistanceToEdge = $distanceToEdge;
			}
			
			//Check how far from the left
			$distanceToEdge = Math.abs($fox_x - 0);
			if($shortestDistanceToEdge > $distanceToEdge)
			{
				$strategy = "TrapLeft";
				$shortestDistanceToEdge = $distanceToEdge;
			}
			
			//Check how far from the right (watch out for 'off by one' error)
			$distanceToEdge = Math.abs($fox_x - ($maxBoardWidth-1));
			if($shortestDistanceToEdge > $distanceToEdge)
			{
				$strategy = "TrapRight";
				$shortestDistanceToEdge = $distanceToEdge;
			}
			console.log($strategy);
		};
		
		//-------------------------------
		// Assign Roles
		//-------------------------------
		function assignRoles(){
			var $closestHoriz="",$closestVert="";
			var $hound1Role="",$hound2Role="",$hound3Role="";
			var $leftTrapperAssigned="False", $rightTrapperAssigned="False", $topTrapperAssigned="False", $bottomTrapperAssigned="False", $houndsAssignedRoles=0;
			
			//Is the hound touching the fox on the right side? If so, make it trap to the left
			if($hound1_x == $fox_x+1 && $hound1_y == $fox_y)
			{
				$hound1Role = "LeftTrapper";
				$leftTrapperAssigned = "True";
				$houndsAssignedRoles++;
			}
			else if($hound2_x == $fox_x+1 && $hound2_y == $fox_y)
			{
				$hound2Role = "LeftTrapper";
				$leftTrapperAssigned = "True";
				$houndsAssignedRoles++;
			}
			else if($hound3_x == $fox_x+1 && $hound3_y == $fox_y)
			{
				$hound3Role = "LeftTrapper";
				$leftTrapperAssigned = "True";
				$houndsAssignedRoles++;
			}
			
			//Is the hound touching the fox on the left side? If so, make it trap to the right
			if($hound1_x == $fox_x-1 && $hound1_y == $fox_y)
			{
				$hound1Role = "RightTrapper";
				$rightTrapperAssigned = "True";
				$houndsAssignedRoles++;
			}
			else if($hound2_x == $fox_x-1 && $hound2_y == $fox_y)
			{
				$hound2Role = "RightTrapper";
				$rightTrapperAssigned = "True";
				$houndsAssignedRoles++;
			}
			else if($hound3_x == $fox_x-1 && $hound3_y == $fox_y)
			{
				$hound3Role = "RightTrapper";
				$rightTrapperAssigned = "True";
				$houndsAssignedRoles++;
			}
			
			//Is the hound touching the fox on the top side? If so, make it trap to the bottom
			if($hound1_x == $fox_x && $hound1_y == $fox_y-1)
			{
				$hound1Role = "BottomTrapper";
				$bottomTrapperAssigned = "True";
				$houndsAssignedRoles++;
			}
			else if($hound2_x == $fox_x && $hound2_y == $fox_y-1)
			{
				$hound2Role = "BottomTrapper";
				$bottomTrapperAssigned = "True";
				$houndsAssignedRoles++;
			}
			else if($hound3_x == $fox_x && $hound3_y == $fox_y-1)
			{
				$hound3Role = "BottomTrapper";
				$bottomTrapperAssigned = "True";
				$houndsAssignedRoles++;
			}
			
			//Is the hound touching the fox on the bottom side? If so, make it trap to the top
			if($hound1_x == $fox_x && $hound1_y == $fox_y+1)
			{
				$hound1Role = "TopTrapper";
				$bottomTrapperAssigned = "True";
				$houndsAssignedRoles++;
			}
			else if($hound2_x == $fox_x && $hound2_y == $fox_y+1)
			{
				$hound2Role = "TopTrapper";
				$bottomTrapperAssigned = "True";
				$houndsAssignedRoles++;
			}
			else if($hound3_x == $fox_x && $hound3_y == $fox_y+1)
			{
				$hound3Role = "TopTrapper";
				$bottomTrapperAssigned = "True";
				$houndsAssignedRoles++;
			}
			
			//Find the hound closest to the fox horizontally (if there's a tie then the earliest hound wins)
			if(Math.abs($hound1_x - $fox_x) <= Math.abs($hound2_x - $fox_x) && Math.abs($hound1_x - $fox_x) <= Math.abs($hound3_x - $fox_x))
			{
				$closestHoriz = "Hound1";
			}
			else if(Math.abs($hound2_x - $fox_x) < Math.abs($hound1_x - $fox_x) && Math.abs($hound2_x - $fox_x) < Math.abs($hound3_x - $fox_x))
			{
				$closestHoriz = "Hound2";
			}
			else
			{
				$closestHoriz = "Hound3";
			}
			
			//Find the hound closest to the fox vertically (if there's a tie then the earliest hound wins)
			if(Math.abs($hound1_y - $fox_y) <= Math.abs($hound2_y - $fox_y) && Math.abs($hound1_y - $fox_y) <= Math.abs($hound3_y - $fox_y))
			{
				$closestVert = "Hound1";
			}
			else if(Math.abs($hound2_y - $fox_y) < Math.abs($hound1_y - $fox_y) && Math.abs($hound2_y - $fox_y) < Math.abs($hound3_y - $fox_y))
			{
				$closestVert = "Hound2";
			}
			else
			{
				$closestVert = "Hound3";
			}
			
			console.log("Hound1=" + $hound1Role + ", Hound2=" + $hound2Role + ", Hound3=" + $hound3Role);
			console.log("Closest horizontally= " + $closestHoriz + ", closest vertically=" + $closestVert);
		};
		
	});
	
	</script>
</head>
<body>
<div class="container">

	<div id="buttonArea">
		<input type='submit' id="foxButton" value="Fox" class="foxButton">
		<input type='submit' id="houndButton1" value="Hound1" class="houndButton">
		<input type='submit' id="houndButton2" value="Hound2" class="houndButton">
		<input type='submit' id="houndButton3" value="Hound3" class="houndButton">
	</div>
		
	<center>	
		<div id="board">
		</div>
	</center>
		
</div>
</body>
</html>
